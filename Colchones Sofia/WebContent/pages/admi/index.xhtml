<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui">
<!--          -->
<!-- TEMPLATE -->
<!--          -->
<ui:composition template="../../template/template-admi.xhtml">
	<!--         -->
	<!-- SECTION -->
	<!--         -->
	<ui:define name="component">
		<h:panelGroup layout="block"
			styleClass="sofia-container-section-generic__center p-p-3">

			<!--       -->
			<!-- VALUE -->
			<!--       -->
			<h:panelGroup layout="block">
				<h:form styleClass="p-d-flex p-jc-between p-ac-center p-flex-wrap">

					<!--        -->
					<!-- BUDGET -->
					<!--        -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-info">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{app.app.global.presupuesto}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Presupuesto"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-dollar-sign"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-center pa-ac-center">
								<p:commandLink value="Ver historial" styleClass="sofia-link" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--       -->
					<!-- SALES -->
					<!--       -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-primary">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.presupuesto_ventas}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Ventas"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-dollar-sign"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-center pa-ac-center">
								<p:commandLink value="Ver ventas" styleClass="sofia-link" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--          -->
					<!-- SHOPPING -->
					<!--          -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-black">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.presupuesto_compras}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Compras"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-dollar-sign"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-center pa-ac-center">
								<p:commandLink value="Ver compras" styleClass="sofia-link" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--           -->
					<!-- CUSTOMERS -->
					<!--           -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-warn">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.cantidad_clientes}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Clientes"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-user-tag"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-star pa-ac-center">
								<p:commandLink value="Ver Clientes" styleClass="sofia-link"
									action="/pages/admi/seller/register?faces-redirect=true" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--           -->
					<!-- SUPPLIERS -->
					<!--           -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-orange">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.cantidad_proveedores}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Proveedores"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-users"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-star pa-ac-center">
								<p:commandLink value="Ver proveedores" styleClass="sofia-link"
									action="/pages/admi/provider/all?faces-redirect=true" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--         -->
					<!-- SELLERS -->
					<!--         -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-succes">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.cantidad_vendedores}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Vendedores"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-user-tie"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-star pa-ac-center">
								<p:commandLink value="Ver vendedores" styleClass="sofia-link"
									action="/pages/admi/seller/all?faces-redirect=true" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>

					<!--          -->
					<!-- CASHIERS -->
					<!--          -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-fatal">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel
										value="#{requests.cantidad_asistente_administrativo}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Asistente Administrativo"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-user-friends"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-star pa-ac-center">
								<p:commandLink value="Ver asistente administrativo"
									styleClass="sofia-link" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>


					<!--          -->
					<!-- PRODUCTS -->
					<!--          -->
					<h:panelGroup layout="block"
						styleClass="sofia-card-budget sofia-card-budget-error">
						<h:panelGroup layout="block"
							styleClass="sofia-card-budget__container">
							<h:panelGroup layout="block" styleClass="p-p-3">
								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-info">
									<h:outputLabel value="#{requests.cantidad_productos}"
										styleClass="sofia-card-budget__container-info-value" />
									<h:outputLabel value="Productos"
										styleClass="sofia-card-budget__container-info-text" />
								</h:panelGroup>

								<h:panelGroup layout="block"
									styleClass="sofia-card-budget__container-icon">
									<i class="fas fa-box"></i>
								</h:panelGroup>
							</h:panelGroup>
							<h:panelGroup layout="block"
								styleClass="sofia-card-budget__container-link p-d-flex p-jc-star pa-ac-center">
								<p:commandLink value="Ver productos" styleClass="sofia-link" />
							</h:panelGroup>
						</h:panelGroup>
					</h:panelGroup>
				</h:form>
			</h:panelGroup>

			<!--       -->
			<!-- LOGIN -->
			<!--       -->
			<p:fieldset legend="Historial" toggleable="true" toggleSpeed="500"
				styleClass="p-mt-6">
				<h:form>
					<p:poll interval="4" update="sofia-table-update"
						listener="#{table.initUsuariosLogeados}" />
					<!--       -->
					<!-- TABLE -->
					<!--       -->
					<p:dataTable var="u" value="#{table.usuarios_logeados}"
						widgetVar="sofia-table-update" id="sofia-table-update"
						emptyMessage="No se encontro ningun usuario."
						filteredValue="#{table.filter_usuarios_logeados}"
						paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} 
								       {CurrentPageReport} {NextPageLink} {LastPageLink}"
						paginator="true" rows="20" rowIndexVar="index"
						rowsPerPageTemplate="5,10,15,20,50,100" reflow="true"
						scrollable="true" styleClass="p-mt-4">

						<!-- HEADER -->
						<f:facet name="header">
							<p:outputPanel layout="block"
								styleClass="p-d-flex p-jc-end p-ac-center">
								<h:outputText value="Buscar:" styleClass="p-mt-1 p-mr-2" />
								<p:inputText id="globalFilter"
									onkeyup="PF('sofia-table-update').filter()" />
							</p:outputPanel>
							<p:outputPanel layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center p-p-3">
								<h2>Usuarios</h2>
								<h4 class="p-as-end">(#{table.usuarios_logeados.size()})</h4>
							</p:outputPanel>
						</f:facet>

						<!-- IMAGE -->
						<p:column footerText="Foto">
							<f:facet name="header">
								<h:outputText value="Foto" />
							</f:facet>
							<h:panelGroup layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center">
								<p:graphicImage rendered="#{u.foto == null}" library="img"
									name="user.png" styleClass="sofia-image-user" />
								<p:graphicImage rendered="#{u.foto != null}"
									value="#{image.usuario}" styleClass="sofia-image-user">
									<f:param name="documento-usuario" value="#{u.documento}" />
								</p:graphicImage>
							</h:panelGroup>
						</p:column>

						<!-- NAME -->
						<p:column filterBy="#{u.persona.nombre} #{u.persona.apellido}"
							sortBy="#{u.persona.nombre} #{u.persona.apellido}"
							footerText="Nombre" filterMatchMode="contains">
							<f:facet name="header">
								<h:outputText value="Nombre" />
							</f:facet>
							<h:panelGroup layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center p-flex-column">
								<h:outputLabel value="#{u.persona.nombre} #{u.persona.apellido}"
									styleClass="p-text-center p-mb-2" />

								<h:panelGroup layout="block"
									styleClass="p-d-flex p-jc-between p-ac-center">
									<h:outputLabel value="#{u.persona.tipoDocumento.nombre}:" />
									<h:outputText value="#{u.persona.documento}"
										styleClass="p-text-center p-p-1 #{u.estado ? 'sofia-statu-succes' : 'sofia-statu-error'} " />
								</h:panelGroup>

							</h:panelGroup>
						</p:column>

						<!-- ROL -->
						<p:column filterBy="#{u.rol.nombre}" sortBy="#{u.rol.nombre}"
							footerText="Rol" filterMatchMode="contains">
							<f:facet name="header">
								<h:outputText value="Rol" />
							</f:facet>
							<h:panelGroup layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center">
								<h:outputText value="#{u.rol.nombre}" />
							</h:panelGroup>
						</p:column>

						<!-- STATU -->
						<p:column
							sortBy="#{u.estado ? (u.session ? 'Conectado': 'Desconectado') : 'Bloqueado'}"
							footerText="Estado" headerText="Estado" filterMatchMode="equals">

							<h:panelGroup layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center">
								<h:outputText
									value="#{u.estado ? (u.session ? 'Conectado': 'Desconectado') : 'Bloqueado'}"
									style="border-radius: 0.5em"
									styleClass="p-p-2 #{u.estado ? (u.session ? 'sofia-statu-succes': 'sofia-statu-warn') : 'sofia-statu-error'}" />
							</h:panelGroup>
						</p:column>

						<!-- DATE -->
						<p:column sortBy="#{u.fechaSesion}" footerText="Fecha Sesión"
							filterMatchMode="contains">
							<f:facet name="header">
								<h:outputText value="Fecha Sesión" />
							</f:facet>
							<h:panelGroup layout="block"
								styleClass="p-d-flex p-jc-center p-ac-center">
								<h:outputText styleClass="p-text-center"
									value="#{u.estado ? (u.session ? u.fechaSesion : 'No se puede mostrar la fecha de sesión porque el usuario esta desconectado.') : 'No se puede mostrar la fecha de sesión porque el usuario esta bloqueado.'}" />
							</h:panelGroup>
						</p:column>
					</p:dataTable>
				</h:form>
			</p:fieldset>
		</h:panelGroup>
	</ui:define>
</ui:composition>
</html>
